# Звіт з лабораторної роботи

## Титульна сторінка
- **Дисципліна:** Навчальна практика
- **Тема роботи:** Розробка WPF-додатка «BillManager»
- **Студент:** Безпалий Артур Антонович
- **Група:** 611П
- **Викладач:** ШЕВЧЕНКО Ілона Володимирівна
- **Дата здачі:** 26.10.2024 р.

## Мета та опис проєкту
Мета роботи — розробити настільний застосунок на C# (.NET 8, WPF, MVVM), що дозволяє формувати, перевіряти та зберігати рахунки (Bill) у текстовому (`.txt`) або JSON (`.json`) форматі. Застосунок має забезпечувати обробку помилок, дружній інтерфейс та можливість перегляду останнього збереженого документа.

Застосунок «BillManager» надає форму введення для опису рахунку (опис, ціна, кількість позицій, ім’я файлу), перевіряє коректність введених даних, зберігає об’єкт `Bill` на диск і відображає статус операції. Через меню доступні функції очищення форми, завантаження останнього рахунку та безпечного завершення роботи.

## Технічна частина
### Використані технології
- Мова програмування: C# 12
- Платформа: .NET 8 (Windows)
- Користувацький інтерфейс: Windows Presentation Foundation (WPF)
- Архітектурний патерн: Model-View-ViewModel (MVVM)
- Формати збереження: JSON, текстові файли

### Архітектура та структура проєкту
```
BillManager.sln
BillManager/
├── App.xaml / App.xaml.cs             # Точка входу WPF-застосунку
├── MainWindow.xaml(.cs)               # Головне вікно та візуальна розмітка
├── Models/                            # Моделі даних (Bill, BillFileFormat)
├── ViewModels/                        # Шар ViewModel (MainViewModel, ObservableObject)
├── Services/                          # Логічні сервіси
│   ├── Validation/                    # Перевірка вхідних даних
│   ├── Storage/                       # Асинхронне збереження та завантаження файлів
│   ├── Messaging/                     # Користувацькі сповіщення
│   └── Application/                   # Керування життєвим циклом застосунку
├── Commands/                          # Реалізація ICommand (RelayCommand, AsyncRelayCommand)
├── README.md                          # Загальний опис і інструкції
└── REPORT.md                          # Поточний звіт
```

### Опис ключових компонентів
- **Bill (Models/Bill.cs):** Імутабельна модель рахунку з полями `Description`, `Price`, `Items`, `CreatedAt`.
- **BillFileFormat (Models/BillFileFormat.cs):** Перелік доступних форматів збереження (`Json`, `Text`).
- **BillValidationService (Services/Validation):** Централізована перевірка полів форми. Правила:
  - Опис — довжина 3–20 символів.
  - Ціна — число > 0 (підтримка локалі та invariant).
  - Кількість — ціле 0–5.
  - Ім’я файлу — 1–10 символів, лише латиниця, цифри або підкреслення.
- **BillStorageService (Services/Storage):** Асинхронне збереження об’єкта `Bill` на диск у вибраному форматі, оновлення метаданих `lastBill.json`, завантаження останнього рахунку. Помилки введення/виведення обгортає у `BillStorageException`.
- **MessageService (Services/Messaging):** Показ інформаційних і помилкових повідомлень користувачу через `MessageBox`.
- **MainViewModel (ViewModels):** Логіка представлення — зв’язок даних форми з моделлю, виклики перевірки та збереження, формування статусу і текстових представлень, команди меню: `SaveBillCommand`, `ViewLastBillCommand`, `ResetFormCommand`, `ExitCommand`.
- **RelayCommand / AsyncRelayCommand (Commands):** Реалізація `ICommand` для синхронних та асинхронних дій у MVVM.

## Користувацький інтерфейс
- **Головне вікно:** містить меню («Create Bill», «View Last Bill», «Exit»), форму введення, блок повідомлень про валідацію, відображення останнього рахунку та рядок стану.
- **Форма введення:** поля `Description`, `Price`, `Items`, `Filename`, вибір формату (`json`, `txt`) та кнопка «Save».
- **Рядок стану:** повідомляє про успіх чи помилку, змінюючи колір тексту.
- **Блок помилок:** відображає перелік порушених правил, якщо їх виявлено.
- **Перегляд останнього рахунку:** група з коротким підсумком і полем, де показуються збережені дані.
- **Сценарій роботи користувача:**
  1. Ввести дані рахунку у форму.
  2. Натиснути «Save». За успішної перевірки та збереження з’являється повідомлення «Bill successfully saved as …».
  3. За порушення правил показуються конкретні підказки (наприклад, «Price must be a valid number greater than 0.»).
  4. Команда «View Last Bill» завантажує останній збережений рахунок і показує його деталі.
  5. Команда «Create Bill» очищує форму для нового введення.
  6. Команда «Exit» безпечно завершує роботу застосунку.
- **Приклади повідомлень:**
  - Успіх: *«Bill successfully saved as invoice.json»*.
  - Помилка валідації: *«Filename must be 1-10 characters long and contain only letters, numbers, or underscores.»*.
  - Помилка збереження: *«Unable to save bill to disk. Please check file permissions and try again.»*.
- **Візуальні матеріали:**  
  `[Скріншот вікна застосунку]`  
  `[Скріншот блоку помилок]`

## Тестування та перевірка
- **Коректне введення:** заповнення всіх полів валідними значеннями, перевірка появи повідомлення про успішне збереження, наявність створеного файлу та оновленої інформації у блоці «Last Saved Bill».
- **Порушення правил:** перевірка реакції на рядки < 3 символів, нечислову ціну, кількість поза діапазоном, ім’я файлу з недопустимими символами — очікуваний перелік помилок і відсутність збереження.
- **Відсутність збережених даних:** запуск команди «View Last Bill» до першого збереження — виведення повідомлення про відсутність даних.
- **Збій запису:** емулювання помилки (наприклад, закриття доступу до каталогу) — застосунок повинен показати повідомлення з `BillStorageException` без аварійного завершення.

## Висновки
У ході роботи створено надійний WPF-застосунок для керування рахунками, реалізований за патерном MVVM. Отримані навички:
- побудова багаторівневої архітектури (Models, ViewModels, Services);
- робота з асинхронними операціями введення/виведення;
- реалізація валідації та обробки винятків;
- проєктування зручного інтерфейсу з зворотним зв’язком.

**Можливі покращення:**
- Додати перелік збережених рахунків та пошук.
- Реалізувати експорт у формати PDF/Excel.
- Під’єднати модульні тести для сервісів валідації та збереження.
- Розширити поля рахунку (наприклад, клієнт, податки, підсумки).

## Додатки
- `BillManager.sln` — проєкт Visual Studio.
- `BillManager/App.xaml` та `App.xaml.cs` — точка входу.
- `BillManager/MainWindow.xaml` — інтерфейс головного вікна.
- `BillManager/ViewModels/MainViewModel.cs` — основна логіка.
- `BillManager/Services/Validation/BillValidationService.cs` — правила перевірки.
- `BillManager/Services/Storage/BillStorageService.cs` — збереження та завантаження рахунків.
- `BillManager/Commands/*.cs` — команди MVVM.
- `[Скріншоти інтерфейсу додаються за потреби]`
